---
# Generated by scripts/aggregate-changelogs. WARNING: Manual edits to this files will be overwritten.
changes_categories:
- Management API
changes_entry:
  repository: giantswarm/azure-admission-controller
  url: https://github.com/giantswarm/azure-admission-controller/blob/master/CHANGELOG.md#300---2021-08-03
  version: 3.0.0
  version_tag: v3.0.0
date: '2021-08-03T10:05:25'
description: Changelog entry for giantswarm/azure-admission-controller version 3.0.0,
  published on 03 August 2021, 10:05
title: azure-admission-controller release v3.0.0
---

### Added
- New `pkg/filter` package with function which checks if the CR belongs to a cluster from a legacy non-CAPI release.
  Release is considered to be "legacy" if it contains azure-operator.
- Unit tests for functions from `release` package.
- `HttpHandlerFactory` for creating HTTP handlers that are using new webhook handlers.
- Cluster webhook handler that replaces mutators and validators.
- AzureCluster webhook handler that replaces mutators and validators.
- MachinePool webhook handler that replaces mutators and validators.
- AzureMachinePool webhook handler that replaces mutators and validators.
- AzureMachine webhook handler that replaces mutators and validators.
- Spark webhook handler that replaces mutator.
- AzureClusterConfig webhook handler that replaces validator.
- AzureConfig webhook handler that replaces validator.
- CR filtering and webhook handler tests that use real CRs from real management clusters as test cases.
### Changed
- Use caching client for `Releases`.
- Upgrade `apiextensions/v2` -> `apiextensions/v3`.
- Upgrade `k8sclient/v4` -> `k8sclient/v5`.
- When importing `sigs.k8s.io/cluster-api/api/v1alpha3` use `capi` as package alias.
- When importing `sigs.k8s.io/cluster-api/exp/api/v1alpha3` use `capiexp` as package alias.
- When importing `sigs.k8s.io/cluster-api-provider-azure/api/v1alpha3` use `capz` as package alias.
- When importing `sigs.k8s.io/cluster-api-provider-azure/exp/api/v1alpha3` use `capzexp` as package alias.
- Remove package names from some file names.
- Move labels mutator functions to `pkg/mutator`.
- Add new `WebhookHandler` interfaces for validation and mutation.
- Prepare helm values to configuration management.
- Update architect-orb to v4.0.0.
- All webhook handlers (previously mutators and validators) are now created in `pkg/app` package.
- The webhook handlers are not added to HTTP handler manually. Now for all handlers we check which wehbook handler
  interfaces are implementing, and according to that we add appropriate HTTP handlers.
- Resource SKU stub API has been moved to `pkg/unittests` since it was being used in multiple places.
